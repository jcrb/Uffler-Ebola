---
title: "Questionnaire EBOLA"
author: "JcB, SUffler"
date: "21 juin 2015"
output:
  pdf_document:
    toc: yes
  html_document:
    toc: yes
---

QR: Evaluation de l'anxiété face à la menace Ebola, au sein du personnel des urgences. Etude multicentrique portant sur deux villes universitaires (Reims et Strasbourg).

Au cours des tests statistiques, une différence est considérée comme significative lorsque __p > 0.05__ (5%). Les tests statistiques utilisés:

- Test t de Student pour comparer 2 variables quantitatives
- Analyse de la variance (ANOVA) pour comparer 3 variables quantitatives ou plus
- Le test du Chi2 pour comparer 2 variables qualitatives ou le test exact de Fisher lorsque les effectifs sont faibles.

Le questionnaire comprend 2 parties:

- des questions factorielles (Ville, catégorie socio-profesionnelle [CSP]) qui permettent de créer des sous groupes.
- 15 questions sous forme d'items de Lickert (7 niveaux de réponses) constituant une échelle de Likert. Pour chaque item, la réponse 
est une variable ordinale (c'est à dire que le rang est significatif) variant de 1 à 7. Le choix de la réponse possible est un nombre impair ce qui implicetement découpe l'éventail des réponses possibles en trois zones:
    - zone de rejet (1 à 3)
    - zone d'indécision (4)
    - zone d'acceptation (5 à 7)
    
Les questions peuvent être regroupées pour former des scores intermédiaires:

    - niveau d'information (1et2)
    - niveau de formation (12.14.15)
    - sentiment provoqué par ebola (3.4.5.13)
    - estime de soi (6.7.8.9.10.11)

Données générales
===================

```{r, echo=FALSE, comment="", message=FALSE}
path <- "../"
file <- paste0(path, "data/TABLEAU EXCEL EBOLA 2015-modifie_3.csv")
d <- read.csv(file)

library(likert)
library(gplots) # plotmeans
library(multcomp) # comparaisons multiples

d$DUREE <- as.character(d$DUREE)
d$DUREE[is.na(d$DUREE)] <- "NON"
d$DUREE <- as.factor(d$DUREE)
d$DUREE <- factor(d$DUREE, levels = c("NON","< 6","6-12",">12"))

n <- nrow(d)

summary(d)
```
Le fichier des données comporte `r n` lignes et `r ncol(d)` variables:
```{r, echo=FALSE, comment=""}
names(d)
```

Les colonnes 2 à 16 correspondent aux items de Likert et 17 à 21 sont des variables factorielles sauf "DUREE".

Répartition des participants:

```{r, echo=FALSE, comment=""}
table(d$VILLE, d$CSP)
x2 <- chisq.test(d$VILLE, d$CSP)

```
Il n'y a pas de différence significative dans la composition des deux échantillons (chi2 = `r round(x2$statistic, 2)`, p = `r round(x2$p.value, 2)`).


Analyse univariée
=================

Catégorie socio-professionnelle
-------------------------------

```{r, echo=FALSE, comment=""}
summary(d$CSP)
```

Ville
-----
```{r, echo=FALSE, comment=""}
summary(d$VILLE)

table(d$VILLE, d$CSP)
chisq.test(d$VILLE, d$CSP)


```

Durée de la formation
---------------------
```{r, echo=FALSE, comment=""}
summary(d$DUREE)

table(d$VILLE, d$DUREE)
x2 <- chisq.test(d$VILLE, d$DUREE)
x2

# fusion des 2 dernières colonnes pour avoir des effectifs > 5
t <- table(d$VILLE, d$DUREE)
t2 <- apply(t[,3:4], 1, sum) # fusion
t3 <- cbind(t[, 1:2], t2) # associe les colonnes 1:2 et la fusion
chisq.test(t3)


# test exact de Fisher
table(d$VILLE, d$DUREE)
fisher.test(d$VILLE, d$DUREE)
```
Il existe une différence significative entre Strasbourg et Reims pour la variable durée.

Likert
======

Score global (somme des 15 items de Likert)
-------------------------------------------
Le score global peut être interprété comme le degré de confiance d'un personnel hospitalier pour la prise en charge d'un patient suspect f'Ebola.

```{r, echo=FALSE, message=FALSE, comment=""}
sg <- d[, 2:16]
score.max.theo <- ncol(sg) * 7
score.min.theo <- 7

# ajout colonne score
sg$score <- apply(sg, 1, sum)
summary(sg$score)
sd(sg$score)
hist(sg$score, main = "Score Ebola", ylab = "Fréquence", xlab = "Score", col = "cornflowerblue", border = "white")

# ajout de la colonne score.tot à d
d$score.tot <- sg[, "score"]

```

### Comparaisons des villes
```{r, echo=FALSE, comment=""}
# comparaison des villes
t.villes <- t.test(d$score.tot ~ d$VILLE)
t.villes
p.villes <- t.villes$p.value
```

### comparaison des CSP
```{r, echo=FALSE, comment=""}
# comparaison des CSP
tapply(d$score.tot, d$CSP, mean)
aov.csp <- summary(aov(d$score.tot ~ d$CSP))
p.csp <- aov.csp[[1]][5]$"Pr(>F)"[1]

```

### comparaison des durées
```{r, echo=FALSE, comment=""}
# durée formation
tapply(d$score.tot, d$DUREE, mean)
fit <- aov(d$score.tot ~ d$DUREE)
summary(fit)

plotmeans(d$score.tot ~ d$DUREE, xlab = "Durée", ylab = "Score moyen", main = "Moyenne des score totaux en fonction de l'ancienneté de la formation\n(avec intervalle de confiance à 95%)")
TukeyHSD(fit)
```


### Conclusions: 

- il n'y a pas de différence entre le score total de Strasbourg et de Reims (p = `r round(p.villes, 2)`), ni entre les différentes CSP (p = `r round(p.csp, 2)`).
- le score global est d'autant plus élevé que le personnel est formé et la formation est récente (mois de 6 mois). Il y a une différence significative entre les formés et les non formés. Dans le groupe des personnels formé, la confiance semble s'estomper avec le temps bien que cette tendance ne soit pas significative (aspect graphique).



Niveau d'information (1.2)
====================

QUEST.1: Je me tiens au courant des dernières informations de la presse télévisée concernant le virus Ebola

QUEST.2: Je me tiens au courant des dernières informations de la presse écrite concernant le virus Ebola

```{r, echo=FALSE, comment="", warning=FALSE}
summary(d$QUEST.1, na.rm = TRUE)
summary(d$QUEST.2, na.rm = TRUE)
tapply(d$QUEST.1, d$VILLE, mean)

boxplot(d$QUEST.1 ~ d$VILLE, main = "Je me tiens au courant des dernières informations de la presse télévisée\n concernant le virus Ebola")

boxplot(d$QUEST.2 ~ d$VILLE, main = "Je me tiens au courant des dernières informations de la presse écrite\n concernant le virus Ebola")

info <- d[,2:3]
l <- likert(info, nlevels = 7)
l
plot(l)

# score presse
score.presse <- apply(d[, 2:3], 1, sum)
summary(score.presse)
hist(score.presse, main = "Score information par la presse", ylab = "Fréquence", xlab = "Score", col = "cornflowerblue", border = "white")
d$score.presse <- score.presse
table(d$CSP, d$score.presse)
barplot(table(d$CSP, d$score.presse))

# pas de différence entre les villes
t.test(d$score.presse ~ d$VILLE)

# pas de différence CSP
fit <- aov(score.presse ~ VILLE, data = d)
summary(fit)

# pas de différence DUREE
fit <- aov(score.presse ~ DUREE, data = d)
summary(fit)

```

Niveau de formation (12.14.15)
==============================

12. Je pense être suffisamment informé(e) quant aux modes de transmissions du virus Ebola

14. Je pense être suffisamment formé(e) pour m’habiller avec la tenue de protection face au virus Ebola

15. Je pense être suffisamment formé(e) pour ôter la tenue de protection face au virus Ebola

```{r, echo=FALSE, comment="", warning=FALSE}
formation <- d[, c(13, 15:16)]
score.formation <- apply(formation, 1, sum)
summary(score.formation)
hist(score.formation, main = "Score formation", ylab = "Fréquence", xlab = "Score", col = "cornflowerblue", border = "white")
d$score.formation <- score.formation

l <- likert(formation, nlevels = 7)
l
plot(l)

### Comparaisons des villes
```{r, echo=FALSE, comment=""}
# comparaison des villes
t.villes <- t.test(d$score.formation ~ d$VILLE)
t.villes
p.villes <- t.villes$p.value
```

### comparaison des CSP
```{r, echo=FALSE, comment=""}
# comparaison des CSP
tapply(d$score.formation, d$CSP, mean)
aov.csp <- summary(aov(d$score.formation ~ d$CSP))
aov.csp
p.csp <- aov.csp[[1]][5]$"Pr(>F)"[1]

plotmeans(d$score.formation ~ d$CSP, xlab = "Durée", ylab = "Score moyen", main = "Moyenne des score totaux en fonction du niveau de formation\n(avec intervalle de confiance à 95%)")
TukeyHSD(aov(d$score.formation ~ d$CSP))

```

### comparaison des durées
```{r, echo=FALSE, comment=""}
# durée formation
tapply(d$score.formation, d$DUREE, mean)
fit <- aov(d$score.tot ~ d$DUREE)
summary(fit)
plotmeans(d$score.formation ~ d$DUREE, xlab = "Durée", ylab = "Score moyen", main = "Moyenne des score totaux en fonction du niveau de formation\n(avec intervalle de confiance à 95%)")
TukeyHSD(fit)
```

Sentiment provoqué par ebola
============================
questions 3.4.5.13 traitent du sentiment provoqué par ebola

3. Le virus Ebola est une chose qui me préoccupe sur le plan professionnel
4. Si j’avais le choix, je refuserais de prendre en charge un patient suspecté d’être contaminé par le virus Ebola
5. Le virus Ebola est une chose qui me préoccupe sur le plan personnel et par rapport à mes proches
13. J’ai très peur à l’idée de devoir prendre en charge un patient suspecté d’être contaminé par le virus Ebola

```{r, echo=FALSE, comment="", warning=FALSE}
sent <- d[, c(4:6,14)]
score.sent <- apply(sent, 1, sum)
summary(score.sent)
hist(score.sent, main = "Score sentiment face à Ebola", ylab = "Fréquence", xlab = "Score", col = "cornflowerblue", border = "white")
d$score.sent <- score.sent

l <- likert(sent, nlevels = 7)
l
plot(l)

### Comparaisons des villes
```{r, echo=FALSE, comment=""}
# comparaison des villes
t.villes <- t.test(d$score.sent ~ d$VILLE)
t.villes
p.villes <- t.villes$p.value
```

### comparaison des CSP
```{r, echo=FALSE, comment=""}
# comparaison des CSP
tapply(d$score.sent, d$CSP, mean)
aov.csp <- summary(aov(d$score.sent ~ d$CSP))
aov.csp
p.csp <- aov.csp[[1]][5]$"Pr(>F)"[1]

```

### comparaison des durées
```{r, echo=FALSE, comment=""}
# durée formation
tapply(d$score.sent, d$DUREE, mean)
fit <- aov(d$score.tot ~ d$DUREE)
summary(fit)
plotmeans(d$score.sent ~ d$DUREE, xlab = "Durée", ylab = "Score moyen", main = "Moyenne des score totaux en fonction du sentiment provoqué par Ebola\n(avec intervalle de confiance à 95%)")
TukeyHSD(fit)
```


estime de soi
=============
questions 6.7.8.9.10.11 traitent de l'estime de soi

6. J’ai peur de ne pas être à la hauteur si je dois prendre en charge un patient suspecté d’être contaminé par le virus Ebola
7. Je me sens confiant(e) quant à mes capacités à collaborer avec les autres professionnels de santé lors de la prise en charge d’un patient suspecté d’être contaminé par le virus Ebola
8. Je me sens confiant(e) quant à mes capacités à prendre en charge un patient suspecté d’être contaminé par le virus Ebola
9. Je suis sûr(e) de pouvoir garder mon calme lors de la prise en charge d’un patient suspecté d’être contaminé par le virus Ebola
10. Je me sens confiant(e) quant à mes capacités à assurer les soins nécessaires lors de la prise en charge d’un patient suspecté d’être contaminé par le virus Ebola
11. Je me sens confiant(e) quant à mes capacités à pouvoir me protéger lors de la prise en charge d’un patient suspecté d’être contaminé par le virus Ebola


```{r, echo=FALSE, comment="", warning=FALSE}
estime <- d[, 7:12]
score.estime <- apply(estime, 1, sum)
summary(score.estime)
hist(score.estime, main = "Score Estime de soi", ylab = "Fréquence", xlab = "Score", col = "cornflowerblue", border = "white")
d$score.estime <- score.estime

l <- likert(estime, nlevels = 7)
l
plot(l)

### Comparaisons des villes
```{r, echo=FALSE, comment=""}
# comparaison des villes
t.villes <- t.test(d$score.estime ~ d$VILLE)
t.villes
p.villes <- t.villes$p.value
```

### comparaison des CSP
```{r, echo=FALSE, comment=""}
# comparaison des CSP
tapply(d$score.estime, d$CSP, mean)
aov.csp <- summary(aov(d$score.estime ~ d$CSP))
aov.csp
p.csp <- aov.csp[[1]][5]$"Pr(>F)"[1]

```

### comparaison des durées
```{r, echo=FALSE, comment=""}
# durée formation
tapply(d$score.estime, d$DUREE, mean)
fit <- aov(d$score.tot ~ d$DUREE)
summary(fit)
plotmeans(d$score.estime ~ d$DUREE, xlab = "Durée", ylab = "Score moyen", main = "Moyenne des score totaux en fonction de l'estime de soi\n(avec intervalle de confiance à 95%)")
TukeyHSD(fit)

```
